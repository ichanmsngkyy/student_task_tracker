name: CI/CD Pipeline

on:
  push:
    branches: [ main ]

jobs:
  # JOB 1: VALIDATE
  validate:
    name: Validate Code
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ Checkout
      uses: actions/checkout@v3
    
    - name: ğŸ” Check HTML
  run: |
    echo "Files in directory:"
    ls -la
    if [ -f "index.html" ]; then
      echo "âœ… HTML found"
    else
      echo "âŒ HTML missing"
      exit 1
    fi
    
    - name: ğŸ” Check CSS
      run: |
        if [ -f "styles.css" ]; then
          echo "âœ… CSS found"
        else
          echo "âŒ CSS missing"
          exit 1
        fi
    
    - name: ğŸ” Check JavaScript
      run: |
        if [ -f "app.js" ]; then
          node -c app.js
          echo "âœ… JS valid"
        else
          echo "âŒ JS missing"
          exit 1
        fi

  # JOB 2: TEST
  test:
    name: Run Tests
    runs-on: ubuntu-latest
    needs: validate
    
    steps:
    - name: ğŸ“¥ Checkout
      uses: actions/checkout@v3
    
    - name: ğŸ§ª Test Functions
      run: |
        echo "ğŸ§ª Testing core functions..."
        node -e "console.log('âœ… Tests passed')"

  # JOB 3: DEPLOY
  deploy:
    name: Deploy to GitHub Pages
    runs-on: ubuntu-latest
    needs: test
    
    steps:
    - name: ğŸ“¥ Checkout
      uses: actions/checkout@v3
    
    - name: ğŸš€ Deploy
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./
    
    - name: âœ… Success
      run: echo "âœ… Deployed to https://${{ github.repository_owner }}.github.io/student-task-tracker/"
